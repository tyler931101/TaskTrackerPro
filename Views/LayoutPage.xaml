<Page x:Class="TicketManagementSystem.Views.LayoutPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Layout">

	<DockPanel>
		<!-- Top Navigation Bar -->
		<Border DockPanel.Dock="Top" Background="{StaticResource PrimaryBrush}" Height="50">
			<DockPanel LastChildFill="False" Background="{StaticResource PrimaryBrush}"  Height="50" VerticalAlignment="Top">
				<!-- Left side: navigation buttons -->
				<StackPanel Orientation="Horizontal" VerticalAlignment="Center" DockPanel.Dock="Left">
					<Button Content="Tickets" Command="{Binding NavigateTicketsCommand}" Style="{StaticResource NavButtonStyle}"/>
					<Button Content="Charts" Command="{Binding NavigateChartsCommand}" Style="{StaticResource NavButtonStyle}"/>
					<Button Content="Dashboard"
							Command="{Binding NavigateDashboardCommand}"
							Style="{StaticResource NavButtonStyle}"
							Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVisibilityConverter}}"/>
				</StackPanel>

				<!-- 🔹 Right side: Avatar Dropdown -->
				<StackPanel Orientation="Horizontal"
							VerticalAlignment="Center"
							DockPanel.Dock="Right"
							Margin="0,0,20,0">

					<Button Style="{StaticResource AvatarButtonStyle}"
							Padding="0"
							Background="Transparent"
							Click="AvatarButton_Click">
						<StackPanel Orientation="Horizontal"
									VerticalAlignment="Center">
							<!-- 🧩 Avatar -->
							<Ellipse Width="32"
									 Height="32"
									 Stroke="White"
									 StrokeThickness="1"
									 Margin="0,0,5,0">
								<Ellipse.Fill>
									<ImageBrush ImageSource="{Binding AvatarPath, TargetNullValue='/Assets/default-avatar.png'}"
												Stretch="UniformToFill"/>
								</Ellipse.Fill>
							</Ellipse>

							<!-- 🧾 Username + Arrow -->
							<TextBlock Text="{Binding CurrentUsername}"
									   Foreground="White"
									   VerticalAlignment="Center"
									   FontSize="14"
									   Margin="0,0,5,0"/>
							<TextBlock Text="▼"
									   Foreground="White"
									   VerticalAlignment="Center"/>
						</StackPanel>

						<!-- 🔹 Dropdown -->
						<Button.ContextMenu>
							<ContextMenu>
								<MenuItem Header="Profile"
										  Command="{Binding NavigateProfileCommand}"/>
								<Separator/>
								<MenuItem Header="Logout"
										  Command="{Binding LogoutCommand}"/>
							</ContextMenu>
						</Button.ContextMenu>
					</Button>
				</StackPanel>
			</DockPanel>
		</Border>

		<!-- Main Content -->
		<Frame x:Name="ContentFrame" NavigationUIVisibility="Hidden"/>
	</DockPanel>
</Page>